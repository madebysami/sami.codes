---
interface Props {
  title: string
  description: string
  liveUrl: string
  githubUrl?: string
  techStack: string[]
  image?: string
  customSvg?: string
}

const { title, description, liveUrl, techStack, image, customSvg } = Astro.props

// A helper for SVGs mapping our themes
const svgClassBase =
  'group-hover:scale-105 transition-transform stroke-brand object-contain p-4'
const svgClassIcon = `${svgClassBase} w-20 h-20`
---

<a
  href={liveUrl}
  target="_blank"
  rel="noopener noreferrer"
  class="block group h-full"
>
  <div
    class="tech-card rounded-lg overflow-hidden h-full flex flex-col bg-surface border border-brand/20 transition-all duration-300 hover:-translate-y-1 hover:border-brand hover:shadow-lg hover:shadow-brand/20"
  >
    <div
      class="h-40 w-full relative flex items-center justify-center border-b border-brand/20 bg-surface"
    >
      {/* 1. Image fallback block */}
      {
        image && (
          <>
            <img
              src={image}
              alt={`Screenshot of ${title}`}
              class="w-full h-full object-cover"
              onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
            />
            {customSvg && (
              <svg
                style="display:none;"
                class="w-full h-full p-8 stroke-brand fill-none"
                viewBox="0 0 200 100"
                aria-hidden="true"
                set:html={customSvg}
              />
            )}
          </>
        )
      }

      {/* 2. Custom SVG block without main image */}
      {
        !image && customSvg && (
          <svg
            class={svgClassBase}
            viewBox={title === 'Tea Break Games' ? '0 0 120 120' : '0 0 24 24'}
            xmlns="http://www.w3.org/2000/svg"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            aria-hidden="true"
            set:html={customSvg}
          />
        )
      }

      {/* 3. Empty placeholder fallback */}
      {
        !image && !customSvg && (
          <svg
            class="w-16 h-16 group-hover:scale-105 transition-transform stroke-brand"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            aria-hidden="true"
          >
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
            <line x1="3" y1="9" x2="21" y2="9" />
            <line x1="9" y1="21" x2="9" y2="9" />
          </svg>
        )
      }
    </div>
    <div class="p-6 flex flex-col flex-grow">
      <h3
        class="text-lg font-bold mb-2 group-hover:underline text-text-primary"
      >
        {title}
      </h3>
      <p class="text-sm mb-4 text-text-secondary flex-grow">{description}</p>
      <ul
        class="flex gap-2 font-mono text-xs flex-wrap text-brand list-none p-0 m-0"
        role="list"
        aria-label="Technologies used"
      >
        {techStack.map((tech) => <li>{tech}</li>)}
      </ul>
    </div>
  </div>
</a>
