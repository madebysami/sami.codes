---
---

<div
  id="cookie-banner"
  class="fixed bottom-0 left-0 right-0 z-50 p-4 md:p-6 bg-surface border-t border-brand/20 shadow-[-10px_-10px_30px_rgba(0,0,0,0.1)] transform translate-y-full transition-transform duration-300 flex flex-col md:flex-row items-center justify-between gap-4 font-mono text-sm hidden"
  aria-live="polite"
>
  <div class="text-text-primary flex-1 max-w-3xl">
    <p class="mb-2">
      <strong class="text-brand">Cookies & Analytics</strong>
    </p>
    <p class="text-text-secondary text-xs md:text-sm">
      We use cookies to enable Google Analytics and understand how you interact
      with the site. You can accept or decline this tracking. No personal
      identifying information is stored.
    </p>
  </div>
  <div class="flex gap-3 shrink-0">
    <button
      id="cookie-decline"
      class="px-4 py-2 rounded border border-text-secondary text-text-secondary hover:bg-surface-alt transition-colors focus:outline-none focus:ring-2 focus:ring-brand focus:ring-offset-2 focus:ring-offset-surface"
    >
      Decline
    </button>
    <button
      id="cookie-accept"
      class="px-4 py-2 rounded bg-brand text-surface font-bold hover:brightness-110 transition-all focus:outline-none focus:ring-2 focus:ring-brand focus:ring-offset-2 focus:ring-offset-surface"
    >
      Accept
    </button>
  </div>
</div>

<script>
  // @ts-nocheck
  const banner = document.getElementById('cookie-banner')
  const acceptBtn = document.getElementById('cookie-accept')
  const declineBtn = document.getElementById('cookie-decline')
  const footerBtn = document.getElementById('cookie-preferences')

  function showBanner() {
    if (banner) {
      banner.classList.remove('hidden')
      setTimeout(() => {
        banner.classList.remove('translate-y-full')
      }, 50)
    }
  }

  function hideBanner() {
    if (banner) {
      banner.classList.add('translate-y-full')
      setTimeout(() => {
        banner.classList.add('hidden')
      }, 300)
    }
  }

  function handleConsent(accepted) {
    if (accepted) {
      localStorage.setItem('cookieConsent', 'granted')
      // @ts-ignore
      if (typeof window.gtag === 'function') {
        // @ts-ignore
        window.gtag('consent', 'update', {
          analytics_storage: 'granted',
        })
      }
    } else {
      localStorage.setItem('cookieConsent', 'denied')
      // @ts-ignore
      if (typeof window.gtag === 'function') {
        // @ts-ignore
        window.gtag('consent', 'update', {
          analytics_storage: 'denied',
        })
      }
    }
    hideBanner()
  }

  const consent = localStorage.getItem('cookieConsent')
  if (!consent) {
    showBanner()
  }

  if (acceptBtn) acceptBtn.addEventListener('click', () => handleConsent(true))
  if (declineBtn)
    declineBtn.addEventListener('click', () => handleConsent(false))

  if (footerBtn) {
    footerBtn.addEventListener('click', (e) => {
      e.preventDefault()
      e.stopPropagation()
      showBanner()
    })
  }
</script>
